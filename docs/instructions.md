# 設計指示書：表記揺れ単語の名寄せプログラム（グラフ理論マージ方式）

## 1. 目的
入力されたテキストファイル内の単語リストに対し、複数の文字列類似度アルゴリズムを用いて表記揺れを検出し、同一グループとして統合・整形して出力する。

## 2. システム構成・使用ライブラリ（推奨）
- **言語**: Python 3.x
- **文字列比較**: `Levenshtein`, `jellyfish` (Jaro-Winkler用)
- **集合処理・N-gram**: `scikit-learn` (TfidfVectorizer等)
- **グラフ構造**: `NetworkX`

---

## 3. 処理フロー

### 3.1 入力
- `input.txt` を読み込み、行ごとに分割してリスト化する。

### 3.2 第一次集計（完全一致）
- 重複する単語を排除し、ユニークな単語リストを作成する（計算コスト削減のため）。

### 3.3 類似度計算とエッジの生成
以下の3つの手法を用い、同一とみなす「しきい値」を超えた単語ペア間にエッジ（つながり）を定義する。

1.  **レーベンシュタイン距離 (Levenshtein Distance)**
    - 編集距離が一定値以下（例：距離2以内、または正規化スコア0.8以上）を同一とする。
2.  **ジャロ・ウィンクラー距離 (Jaro-Winkler Distance)**
    - スコアが一定値以上（例：0.9以上）を同一とする。
3.  **N-gram (Cosine Similarity)**
    - 文字単位のBi-gram等でベクトル化し、コサイン類似度が一定値以上を同一とする。

### 3.4 グラフ理論によるマージ
- 各単語を**ノード（点）**、3.3で判定された「同一性」を**エッジ（線）**とする無向グラフを構築する。
- **NetworkXの `connected_components`** 等のアルゴリズムを用い、連結成分（直接、または別の単語を介してつながっているグループ）を抽出する。

---

## 4. 出力仕様
処理結果を `output.txt` に以下の形式で書き出す。

- **番号付け**: 各グループの先頭行に `1. ` (半角数字 + 半角ピリオド + 半角スペース) を付与。
- **グループ表現**:
    - グループ内の最初の要素：番号付き
    - 2番目以降の要素：行頭に `- ` (半角ハイフン + 半角スペース) を付与
- **単一項目の扱い**: グループ化されなかった単語も、独立した番号付き項目として出力する。

### 出力例
```markdown
1. 株式会社カンパニー
- （株）カンパニー
- ㈱カンパニー
2. サンプル株式会社
- sample 株式会社
- サンプル
3. 独立した単語A
```

---

## 5. 実装上の留意事項
- **しきい値の調整**: 各アルゴリズムのしきい値は、データの性質に合わせて外部変数（定数）として定義し、調整可能にすること。
- **計算量**: 単語数が極めて多い場合、総当たり比較 ($O(N^2)$) によるメモリ不足に注意し、必要に応じてブロッキング処理を検討すること。
- **順序**: グループ内の「最初の要素」は、元のリストで出現頻度が高いもの、または文字列長が最も適切なものを選択するロジックを検討すること（基本はリストの出現順で可）。